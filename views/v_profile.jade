extends ./g_layout.jade
block vars
  - var page = 'profile'
  - var days_name = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi']
  - var months_name = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre']
  - var client_schools = ['École Père-Marquette', 'École Louis-Riel'];
  - /* parse a date in yyyy-mm-dd format*/ function parseDate(input) {var parts = input.match(/(\d+)/g);/* new Date(year, month [, date [, hours[, minutes[, seconds[, ms]]]]])*/return new Date(parts[0], parts[1]-1, parts[2]); /* months are 0-based*/}
  - function correctDate(date){var tz_offset = (new Date()).getTimezoneOffset() * 60 * 1000;var corrected_datetime = new Date(parseDate(date).getTime() + tz_offset);return corrected_datetime}
  - function addHoursIfExists(arr){return arr.reduce(function(acc, curV, curI) {if(curV > 0 ){return acc + curV;} else {return acc;}})}



block head
  title Profil de bénévole
  meta(name='description', content='Accède à tes informations personnelles')
block content
  #map-section.container-fluid
    .row
      .col-md-5.col-md-offset-1
        h3.page-header <strong> #{volunteer.firstname} #{volunteer.lastname}  </strong>
        if lt_hours_done
          p <i class='fa fa-2x fa-link fa-pull-left fa-border'></i> <b>Engagements</b> <br> #{lt_hours_done} heures confirmées
        else 
          p <i class='fa fa-2x fa-link fa-pull-left fa-border'></i> <b>Engagements</b> <br> 0 heures confirmées
        if events_hours_done || extras_hours_done || manuals_hours_done
          p <i class='fa fa-2x fa-trophy fa-pull-left fa-border'></i> <b>Évènements</b> <br> #{addHoursIfExists([events_hours_done, extras_hours_done, manuals_hours_done])} heures confirmées
        else 
          p <i class='fa fa-2x fa-trophy fa-pull-left fa-border'></i> <b>Évènements</b> <br> 0 heures confirmées
      if vol_level
        .col-md-5
          .media.tp-15(style='margin-top: 6%')
            if (vol_level == 1)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_10.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-default Débutant
                p.text-info <strong>Conseil : </strong> Inscris-toi à une activité bénévole pour augmenter ton niveau d'engagement !
            if (vol_level == 2)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_25.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-info Apprenti
                p.text-info <strong>Conseil : </strong> Une fois ton opération bénévole terminée, fais valider ta participation via ton tableau de bord !
            if (vol_level == 3)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_40.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-primary Gros potentiel
                p.text-info <strong>Conseil : </strong> Il ne te manque que quelques heures supplémentaires de bénévolat pour passer au rang suivant !
            if (vol_level == 4)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_55.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-success Force vive
                if (events_hours_done == 0)
                  p.text-info <strong>Conseil : </strong> Participe à ton premier évènement et fais valider tes heures par l'organisme afin de monter de niveau !
                else
                  p.text-info <strong>Conseil : </strong> Augmente ton nombre d'heures d'implication pour atteindre le niveau suivant !
            if (vol_level == 5)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_70.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-warning Formidable
                if (events_hours_done == 0)
                  p.text-info <strong>Conseil : </strong> Pour devenir un expert du bénévolat, il faut maintenant que tu participes aussi à un évènement ponctuel !
                else if (lt_hours_done == 0)
                  p.text-info <strong>Conseil : </strong> Participe à ton premier engagement à long terme afin de devenir un expert du bénévolat !
                else
                  p.text-info <strong>Conseil : </strong> Il ne te reste plus beaucoup d'heures d'implication pour devenir un expert du bénévolat !
            if (vol_level == 6)
              .media-left.media-middle(style='width: 40vw')
                img.media-object(src='/images/grade_max.png' width='100')
              .media-body
                h3.media-heading <strong>Mon niveau d'engagement</strong>
                h3
                  span.label.label-danger Expert
                p.text-info <strong>Conseil : </strong> Maintenant que tu es un expert, continue de t'impliquer afin de relever les challenges à venir sur la plateforme !
            if (client_schools.indexOf(volunteer.admin.school_name) != -1)
              a.btn.btn-default.pull-right(href='/volunteer/extra_simplyk_hours', role='button', style='background-color: transparent; color: black;') Ajouter des heures extra-Simplyk
                i.fa.fa-plus



    .row
      .col-md-10.col-md-offset-1
        ul.nav.nav-tabs(role='tablist')
          li.active(role='navigation')
            a(href='#participations' aria-controls='participations' role='tab' data-toggle='tab') 
              h4 Mes participations 
                span.badge= volunteer.events.length + volunteer.long_terms.length
          li(role='navigation')
            a(href='#profile' aria-controls='profile' role='tab' data-toggle='tab') 
              h4 Mes informations
          if (volunteer.admin.school_name && (client_schools.indexOf(volunteer.admin.school_name) != -1))
            li(role='navigation')
              a(href='#extras' aria-controls='extras' role='tab' data-toggle='tab') 
                if (client_schools.indexOf(volunteer.admin.school_name) != -1)
                  h4.school_name #{volunteer.admin.school_name} 
                    if volunteer.extras && volunteer.manuals
                      span.badge= volunteer.extras.length + volunteer.manuals.length
                else 
                  h4 Mon école 
                    if volunteer.extras && volunteer.manuals
                      span.badge= volunteer.extras.length + volunteer.manuals.length

    .row
      .tab-content
        #participations.tab-pane.fade.active.in(role='tabpanel')
          .col-md-4.col-md-offset-1
            .page-header
              h2 Participations ponctuelles
            #offers-list.no-side-padding
                ul.list-group.list-opportunity
                  unless (events_past || events_confirmed || events_pending || events_subscribed)
                    p Pas d'inscriptions

                  //IF EVENT_PAST
                  if events_past.length
                    h4 CONFIRMER VOTRE VENUE
                  each event, index in events_past
                    li.list-group-item
                      .panel.panel-default
                        .panel-heading
                          div.media-left.media-middle
                            a(href='profile')
                              img.media-object.little-img(src='/images/clouds.jpg')
                          div.media-body
                            h4.media-heading <b>#{event.intitule}</b> <small>(#{event.intitule_activity})</small>
                            h6 <small>pour</small> #{event.org_name}
                        .panel-body
                          h6
                            i.fa.fa-map-marker
                            p.inline Adresse : #{event.address}
                          h6.inline
                            i.fa.fa-calendar-o
                            p.inline #{days_name[correctDate(event.day).getDay()]  + ' ' + (correctDate(event.day).getDate()) + ' ' + months_name[correctDate(event.day).getMonth()]  + ' ' + correctDate(event.day).getFullYear()}
                        .panel-footer
                          form(method='post' action='/volunteer/hours_pending/'+event.activity_id+'-'+event.day, id='hoursPendingForm'+event.activity_id+event.day)
                            div.input-group
                              input.form-control(id='input'+event._id, type='number', min='0.5', max='50', step='0.5' placeholder='Heures réalisées' name='hours_pending', required)
                              .input-group-btn
                                input.btn.btn-default(type='submit', value='Confirmer' form='hoursPendingForm'+event.activity_id+event.day)
                                a.btn.btn-default(href='/volunteer/event/'+event.activity_id) Détails
                        #identifiant(style='display:none')
                          p= event._id

                  // IF EVENT_PENDING
                  if events_pending.length
                    h4 EN ATTENTE DE CONFIRMATION
                  each event, index in events_pending
                    li.list-group-item
                      .panel.panel-default
                        .panel-heading
                          div.media-left.media-middle
                            a(href='profile')
                              img.media-object.little-img(src='/images/clouds.jpg')
                          div.media-body
                            h4.media-heading <b>#{event.intitule}</b> <small>(#{event.intitule_activity})</small>
                            h6 <small>pour</small> #{event.org_name}
                        .panel-body
                          h6
                            i.fa.fa-map-marker
                            p.inline Adresse : #{event.address}
                          h6.inline
                            i.fa.fa-calendar-o
                            p.inline #{days_name[correctDate(event.day).getDay()]  + ' ' + (correctDate(event.day).getDate()) + ' ' + months_name[correctDate(event.day).getMonth()]  + ' ' + correctDate(event.day).getFullYear()}
                        .panel-footer
                          ul.list-inline
                            li
                              a.btn.btn-default(id= event._id, href='/volunteer/event/'+event.activity_id) Détails
                            li
                              h4.text-right
                                if event.hours_pending
                                  span.badge(style='background-color: #E33831')= event.hours_pending + ' heures à confirmer'
                        #identifiant(style='display:none')
                          p= event._id

                  // IF EVENT_SUBSCRIBED
                  if events_subscribed.length
                    h4 À VENIR
                  each event, index in events_subscribed
                    li.list-group-item
                      .panel.panel-default
                        .panel-heading
                          div.media-left.media-middle
                            a(href='profile')
                              img.media-object.little-img(src='/images/clouds.jpg')
                          div.media-body
                            h4.media-heading <b>#{event.intitule}</b> <small>(#{event.intitule_activity})</small>
                            h6 <small>pour</small> #{event.org_name}
                        .panel-body
                          h6
                            i.fa.fa-map-marker
                            p.inline Adresse : #{event.address}
                          h6.inline
                            i.fa.fa-calendar-o
                            p.inline #{days_name[correctDate(event.day).getDay()]  + ' ' + (correctDate(event.day).getDate()) + ' ' + months_name[correctDate(event.day).getMonth()]  + ' ' + correctDate(event.day).getFullYear()}
                        .panel-footer
                          .btn-group(role='group')
                            a.btn.btn-default(href='/volunteer/event/'+event.activity_id) Détails
                            input.btn.btn-warning(type='button' value='Se désinscrire' data-toggle='modal' data-target='#unsubscribe-modal'+index)
                          .modal.fade(id='unsubscribe-modal'+index, tab-index='-1' role='dialog' aria-labelledby='myModalLabel'+index)
                            .modal-dialog(role='document')
                              .modal-content
                                .modal-header
                                  button.close(type='button' data-dismiss="modal" aria-label="Close")
                                    span(aria-hidden='true') &times;
                                  h4.modal-title(id='myModalLabel'+index) Es-tu sûr de vouloir te désinscrire de cette activité ?
                                .modal-footer
                                  form.inline(action='/volunteer/unsubscribe/'+event.activity_id+'-'+event.day, method='post')
                                    .btn-group
                                      a.btn.btn-warning(data-dismiss='modal') Annuler
                                      input.btn.btn-default(type='submit' value='Oui' role='button')

                  // IF EVENT_CONFIRMED
                  if events_confirmed.length
                    h4 ÉVÈNEMENTS PASSÉS
                  each event, index in events_confirmed
                    li.list-group-item
                      .panel.panel-default
                        .panel-heading
                          .media
                            div.media-left.media-middle
                              a(href='profile')
                                img.media-object.little-img(src='/images/clouds.jpg')
                            div.media-body
                              h4.media-heading <b>#{event.intitule}</b> <small>(#{event.intitule_activity})</small>
                              h6 <small>pour</small> #{event.org_name}
                        .panel-body
                          h6
                            i.fa.fa-map-marker
                            p.inline Adresse : #{event.address}
                          h6.inline
                            i.fa.fa-calendar-o
                            p.inline #{days_name[correctDate(event.day).getDay()]  + ' ' + (correctDate(event.day).getDate()) + ' ' + months_name[correctDate(event.day).getMonth()]  + ' ' + correctDate(event.day).getFullYear()}
                        .panel-footer
                          ul.list-inline
                            li
                              a.btn.btn-default(id= event._id, href='/volunteer/event/'+event.activity_id) Détails
                            li
                              h4.text-right
                                if event.hours_done
                                  span.badge(style='background-color: #113A20')= event.hours_done + ' heures réalisées'
                        #identifiant(style='display:none')
                          p= event._id
          .col-md-4.col-md-offset-2
            .page-header
              h2 Engagements long terme
            #offers-list.no-side-padding
                ul.list-group.list-opportunity
                  unless (volunteer.long_terms)
                    p Pas d'inscriptions
                  //IF EVENT_PAST
                  if volunteer.long_terms.length
                    each lt, lt_i in volunteer.long_terms
                      li.list-group-item.list-longterm-item(id= lt._id)
                        .panel.panel-default
                          .panel-heading
                            div.media-left.media-top
                              a(href='profile')
                                img.media-object.little-img(src='/images/clouds.jpg')
                            div.media-body
                              h4.media-heading <b>#{lt.intitule}</b>
                              h6 <small>pour</small> #{lt.org_name}
                          .panel-body
                            h6
                              i.fa.fa-map-marker
                              p.inline Adresse : #{lt.address}
                            h6.inline
                              i.fa.fa-info
                              p.inline= lt.description
                            if lt.hours_done || lt.hours_pending
                              h4
                                if lt.hours_done
                                  span.badge(style='background-color: #113A20')= lt.hours_done + ' heures réalisées '
                                if lt.hours_pending
                                  span.badge(style='background-color: #E33831')= lt.hours_pending + ' heures à confirmer '
                          .panel-footer
                            .btn-group
                              a.btn.infos-button-longterm.longterm(id= lt._id, href='/longterm/'+lt._id) Détails
                              button.btn.btn-warning(data-toggle='modal' data-target='#addLTHoursModal'+lt_i) Ajouter des heures
                      .modal.fade(tabindex='-1', role='dialog' aria-labelledby="addLTHoursModalLabel", id='addLTHoursModal'+lt_i)
                        div.modal-dialog(role='document')
                          form.modal-content.addLTHoursForm(id='addLTHoursForm'+lt_i, method='post', action='/volunteer/LThours_pending/'+lt._id)
                            .modal-header
                              button(type='button' class="close" data-dismiss="modal" aria-label="Close")
                                span(aria-hidden='true')
                                h4.modal-title Ajout d'heures
                            div.modal-body
                              div.form-group
                                label(for='addLTHoursInput') Combien d'heures as-tu effectué dernièrement ?
                                input.form-control(name='hours_pending', type='number', min='0.5', max='50', step='0.5', form='addLTHoursForm'+lt_i, required)
                            div.modal-footer
                              a.btn.btn-default(data-dismiss='modal') Annuler
                              input.btn.btn-warning(type='submit' form='addLTHoursForm'+lt_i, value='Envoyer')
        #profile.tab-pane.fade(role='tabpanel')
          .col-md-6.col-md-offset-3
            .page-header
              h3.text-center
                p #{volunteer.firstname} <strong>#{volunteer.lastname}</strong>
              if error
                p.alert.alert-danger #{error}
              p#edit-alert-danger.alert.alert-danger.hidden.text-center
              p#edit-alert-success.alert.alert-success.hidden.text-center
            ul.list-group
              li.list-group-item
                h5.text-center
                  i.inline.fa.fa-birthday-cake(aria-hidden="true") 
                  p.inline= ' ' + moment(volunteer.birthdate).format("DD/MM/YYYY")
              if volunteer.phone
                li.list-group-item
                  h5.text-center
                    i.inline.fa.fa-mobile(aria-hidden="true") 
                    p.inline#phone #{volunteer.phone}
                    a.inline.btn(data-toggle='modal' data-target='#phone_edit_modal')
                      i.fa.fa-pencil
              else
                li.list-group-item
                  h5.text-center
                    i.inline.fa.fa-mobile(aria-hidden="true") 
                    p.inline#phone Ajouter mon numéro de téléphone
                    a.inline.btn(data-toggle='modal' data-target='#phone_edit_modal')
                      i.fa.fa-plus
              .modal.fade(tabindex='-1', role='dialog' aria-labelledby="extraModalLabel", id='phone_edit_modal')
                div.modal-dialog(role='document')
                  .modal-content
                    form.edit-form#phone-edit-form
                      .modal-header
                        button(type='button' class="close" data-dismiss="modal" aria-label="Close")
                          span(aria-hidden='true')
                          h4.modal-title Édition de mon numéro de téléphone
                      div.modal-body
                          label(for='phone') Nouveau numéro de téléphone
                          input.form-control(type='text', name='phone')
                      .modal-footer
                        input.btn.btn-warning(type='submit', form='phone-edit-form', value='Valider')
                        a.btn.btn-default(data-dismiss='modal') Fermer
              if (volunteer.admin && volunteer.admin.school_name)
                li.list-group-item
                  h5.text-center
                    i.inline.fa.fa-university(aria-hidden="true") 
                    p.inline.school_name #{volunteer.admin.school_name}
                    a.inline.btn(data-toggle='modal' data-target='#school_edit_modal')
                      i.fa.fa-pencil
              else
                li.list-group-item
                  h5.text-center
                    i.inline.fa.fa-university(aria-hidden="true") 
                    p.inline.school_name Ajouter mon établissement scolaire
                    a.inline.btn#add_a_school(data-toggle='modal' data-target='#school_edit_modal')
                      i.fa.fa-plus
              .modal.fade(tabindex='-1', role='dialog' aria-labelledby="extraModalLabel", id='school_edit_modal')
                div.modal-dialog(role='document')
                  .modal-content
                    form.edit-form#school-edit-form
                      .modal-header
                        button(type='button' class="close" data-dismiss="modal" aria-label="Close")
                          span(aria-hidden='true')
                          h4.modal-title Édition de mon établissement scolaire
                      if !(volunteer.admin && volunteer.admin.school_name)
                        div.modal-body
                          label(for='school_name') Mon établissement scolaire
                          select#school_name.form-control(placeholder='', name='school_name', aria-describedby='basic-addon1')
                            each school, school_i in schools_list
                              option= school
                        .modal-footer
                          input.btn.btn-warning(type='submit', form='school-edit-form', value='Valider')
                          a.btn.btn-default(data-dismiss='modal') Fermer
                      else if client_schools.indexOf(volunteer.admin.school_name) == -1
                        div.modal-body
                          label(for='school_name') Changer mon établissement scolaire
                          select#school_name.form-control(placeholder='', name='school_name', aria-describedby='basic-addon1')
                            each school, school_i in schools_list
                              option= school
                        .modal-footer
                          input.btn.btn-warning(type='submit', form='school-edit-form', value='Valider')
                          a.btn.btn-default(data-dismiss='modal') Fermer
                      else
                        div.modal-body
                          h4.text-center Comme tu as la chance d'être élève dans un établissement scolaire client de Simplyk, tu ne peux pas changer ton établissement scolaire :)
                        .modal-footer
                          a.btn.btn-default(data-dismiss='modal') Fermer
              li.list-group-item
                  h5.text-center
                    i.inline.fa.fa-at(aria-hidden="true") 
                    p.inline #{volunteer.email}
              li.list-group-item#password-group(style='margin-bottom: 60px')
                h5.text-center
                  i.inline.fa.fa-key(aria-hidden="true")
                  p.inline Mot de passe: #[span.display ******]
                  a.inline.btn#edit-password-button.display
                    i.fa.fa-pencil
                  form#edit-password-form.form-horizontal.hidden.editing
                    .input-group.conn-input
                      p#password-error.alert.alert-danger.hidden Mot de passe incorrect
                      .input-group.conn-input
                        input.form-control(name="current-password", type="password", placeholder="Mot de passe actuel")
                      .input-group.conn-input
                        input.form-control(name="new-password", type="password", placeholder="Nouveau mot de passe")
                      .input-group.conn-input
                        input.form-control(name="confirm-password", type="password", placeholder="Confirmer mot de passe")
                  div.btn-toolbar
                      button.btn.btn-default#cancel-password-button.editing.hidden Annuler
                      button.btn.btn-default#save-password-button.editing.hidden Enregistrer
        #extras.tab-pane.fade(role='tabpanel')
          .col-md-4.col-md-offset-1
            .page-header
              h3 Extra-Simplyk
              h5 Les engagements que j'ai rentré à la main sur la plateforme car j'y avais participé sans passer par Simplyk
              h3
              if error
                p.alert.alert-danger #{error}
              #offers-list.no-side-padding
                ul.list-group.list-opportunity
                  unless (volunteer.extras.length > 0)
                    p <b>Pas d'extras</b>
                  //IF EVENT_PAST
                  if volunteer.extras.length
                    each ext, ext_i in volunteer.extras
                      li.list-group-item.list-extra-item(id= ext._id)
                        .panel.panel-default
                          .panel-heading
                            div.media-left.media-top
                              a(href='profile')
                                img.media-object.little-img(src='/images/clouds.jpg')
                            div.media-body
                              h4.media-heading <b>#{ext.intitule}</b>
                              h6 <small>pour</small> #{ext.org_name}
                          .panel-body
                            h6.inline
                              i.fa.fa-info
                              p.inline= ext.description
                            if ext.hours_done || ext.hours_pending
                              h4
                                if ext.hours_done
                                  span.badge(style='background-color: #113A20')= ext.hours_done + ' heures réalisées '
                                if ext.hours_pending
                                  span.badge(style='background-color: #E33831')= ext.hours_pending + ' heures à confirmer '
                          .panel-footer
                            .btn-group
                              button.btn.infos-button-extra.extra(id= ext._id, data-toggle='modal' data-target='#extraModal'+ext_i) Détails
                      .modal.fade(tabindex='-1', role='dialog' aria-labelledby="extraModalLabel", id='extraModal'+ext_i)
                        div.modal-dialog(role='document')
                          .modal-content
                            .modal-header
                              button(type='button' class="close" data-dismiss="modal" aria-label="Close")
                                span(aria-hidden='true')
                                h4.modal-title Détails de l'extra
                            div.modal-body
                              if ext.student_questions && ext.student_answers
                                h4 <b>Tes feedbacks</b>
                                each question, question_i in ext.student_questions
                                  div.panel.panel-warning
                                    div.panel-heading
                                      h6= question
                                    div.panel-body
                                      h6= ext.student_answers[question_i]
                              if ext.organism_questions.length && ext.organism_answers.length
                                h4 <b>Les feedbacks de l'organisme</b>
                                each question, question_i in ext.organism_questions
                                  div.panel.panel-warning
                                    div.panel-heading
                                      h6= question
                                    div.panel-body
                                      h6= ext.organism_answers[question_i]
                              else
                                h4 <b>En attente des feedbacks de l'organisme...</b>
                            div.modal-footer
                                a.btn.btn-default(data-dismiss='modal') Fermer
          .col-md-4.col-md-offset-2
            .page-header
              h3 Ajoutées par mes professeurs
              h5 Les engagements que mes professeurs m'ont ajouté et validé
              h3
              #offers-list.no-side-padding
                ul.list-group.list-opportunity
                  if volunteer.manuals
                    if volunteer.manuals.length
                      each man, man_i in volunteer.manuals
                        li.list-group-item.list-extra-item(id= man._id)
                          .panel.panel-default
                            .panel-heading
                              div.media-left.media-top
                                a(href='profile')
                                  img.media-object.little-img(src='/images/clouds.jpg')
                              div.media-body
                                h4.media-heading <b>#{man.admin_name}</b>
                                if (man.added)
                                  h6 <small>ajouté le</small> #{(new Date(man.added)).toLocaleDateString()}
                            .panel-body
                              h6.inline
                                i.fa.fa-info
                                p.inline= man.description
                              if man.hours_done
                                h4
                                  if man.hours_done
                                    span.badge(style='background-color: #113A20')= man.hours_done + ' heures réalisées '

block footscript
  script(src='/javascripts/edit-password.js')
  script(src='/bower_components/bootstrap3-dialog/dist/js/bootstrap-dialog.js')

  //Modal bootstrap
  script(type='text/javascript').
    $('#myModal').on('shown.bs.modal', function () {
      $('#myInput').focus();
    });
  script(type='text/javascript').
    $(document).ready(function(){
      $('.edit-form').submit(function(event){
        console.log('Submit an edit-form');
        console.log('$(this).attr("id) : ' + $(this).attr('id'))
        event.preventDefault();
        const form_datas = $(this).serializeArray();
        let datas = {};
        const modal = $(this).closest('.modal');
        if ($(this).attr('id') == 'phone-edit-form'){
          console.log('The edit-form submit is a phone one');
          datas.phone = form_datas[0].value;
          $.post('/edit-profile', datas)
          .done(function(data){
            modal.modal('toggle');
            $('#edit-alert-success').removeClass('hidden');
            $('#edit-alert-success').html(' Numéro de téléphone modifié avec succès pour : ' + data.newPhone);
            $('#phone').html('' + data.newPhone);
          })
          .fail(function(data){
            modal.modal('toggle');
            $('#edit-alert-danger').removeClass('hidden');
            $('#edit-alert-danger').html(' ' + data.responseJSON.error);
            console.log(data.error);
          })
        } else if ($(this).attr('id') == 'school-edit-form'){
          console.log('The edit-form submit is a school one');
          datas.school_name = form_datas[0].value;
          $.post('/edit-profile', datas)
          .done(function(data){
            modal.modal('toggle');
            $('#edit-alert-success').removeClass('hidden');
            $('#edit-alert-success').html(' Établissement scolaire modifié avec succès pour : ' + data.newSchool);
            $('.school_name').html('' + data.newSchool);
            $('#add_a_school').addClass('hidden');
          })
          .fail(function(data){
            modal.modal('toggle');
            $('#edit-alert-danger').removeClass('hidden');
            $('#edit-alert-danger').html(' ' + data.responseJSON.error);
            console.log(data.error);
          })
        }
      })
    });
