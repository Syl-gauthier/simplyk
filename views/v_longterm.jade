extends ./g_layout.jade
block vars
  - var page = 'longterm'
  - var days_name = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi']
  - var months_name = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre']
  - function correctDate(date){var tz_offset = (new Date()).getTimezoneOffset() * 60 * 1000;var corrected_datetime = new Date(date.getTime() + tz_offset);return corrected_datetime}

block content
  .container-fluid
    .row
      .col-md-6.col-md-offset-1
        .page-header
          if (alreadySubscribed)
            h1= longterm.intitule + ' '
              span.badge Inscrit
          else
            h1= longterm.intitule
          p= longterm.description
          p <b>Adresse : </b> #{longterm.address}
            li.list-group-item
              div.media-left.media-middle
                i.fa.fa-calendar
              div.media-body
                h4 Horaires possibles :
                table.table(id='slot')
                  thead
                    tr
                      th.text-center #
                      th.text-center Lundi
                      th.text-center Mardi
                      th.text-center Mercredi
                      th.text-center Jeudi
                      th.text-center Vendredi
                      th.text-center Samedi
                      th.text-center Dimanche
                  tbody
                    tr
                      th.text-center(scope='row') AM
                      td
                        if slotJSON['mondayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['tuesdayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['wednesdayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['th.text-centerursdayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['fridayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['saturdayAM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['sundayAM']
                          i.fa.fa-check
                        else
                          p
                    tr
                      th.text-center(scope='row') PM
                      td
                        if slotJSON['mondayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['tuesdayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['wednesdayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['th.text-centerursdayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['fridayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['saturdayPM']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['sundayPM']
                          i.fa.fa-check
                        else
                          p
                    tr
                      th.text-center(scope='row')= 'Soir (>16h)'
                      td
                        if slotJSON['mondayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['tuesdayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['wednesdayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['th.text-centerursdayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['fridayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['saturdayEVE']
                          i.fa.fa-check
                        else
                          p
                      td
                        if slotJSON['sundayEVE']
                          i.fa.fa-check
                        else
                          p
      .col-md-4.col-md-offset-1
        .page-header
          h4 L'organisme :
          h2= organism.org_name
          p='Mission: ' + organism.description
          p= 'Courriel: ' + organism.email
          p= 'Téléphone: ' + organism.phone
        if (alreadySubscribed)
          .panel.panel-default
            .panel-heading
              div.media
                div.media-left.media-top
                  h4 <strong>Mon engagement</strong>
                div.media-top.media-right
                  button.btn.longterm(data-toggle='modal' data-target='#addLTHoursModal')
                    i.fa.fa-plus
                    p.inline Ajouter des heures
              #addLTHoursModal.modal.fade(tabindex='-1', role='dialog' aria-labelledby="addLTHoursModalLabel")
                div.modal-dialog(role='document')
                  form.modal-content.addLTHoursForm(id='addLTHoursForm'+longterm._id, method='post', action='/volunteer/LThours_pending/'+longterm._id)
                    .modal-header
                      button(type='button' class="close" data-dismiss="modal" aria-label="Close")
                        span(aria-hidden='true')
                        h4.modal-title Ajout d'heures
                      div.modal-body
                        div.form-group
                          label(for='addLTHoursInput') Combien d'heures as-tu effectué dernièrement ?
                          input.form-control(name='hours_pending', type='number', min=1, max=50, form='addLTHoursForm'+longterm._id, required)
                      div.modal-footer
                        a.btn.btn-default(data-dismiss='modal') Annuler
                        input.btn.btn-warning(type='submit' form='addLTHoursForm'+longterm._id, value='Envoyer')
            .panel-body
              table.table(id='achievements')
                  thead
                    tr
                      th.text-center Heures réalisées
                      th.text-center Heures à confirmer
                  tbody
                    tr
                      td
                        if (hours_done)
                          p.text-center= hours_done + 'h'
                        else
                          p.text-center 0h
                      td
                        if (hours_pending)
                          p.text-center= hours_pending + 'h'
                        else
                          p.text-center 0h
    .row
      .col-md-10.col-md-offset-1
        if (!alreadySubscribed)
          input.btn.btn-default(type='button' value='S\'inscrire' data-toggle='modal' data-target='#longterm-modal')
          .modal.fade(id='longterm-modal' tab-index='-1' role='dialog' aria-labelledby='myModalLabel')
            .modal-dialog(role='document')
              .modal-content
                .modal-header
                  button.close(type='button' data-dismiss="modal" aria-label="Close")
                    span(aria-hidden='true')&times;
                  h4.modal-title(id='myModalLabel') Es-tu sûr de vouloir t'inscrire à cet engagement ?
                .modal-footer
                  a.btn.btn-warning(data-dismiss='modal') Annuler
                  form.inline(action='/volunteer/longterm/subscribe/'+longterm._id, method='post')
                    input.btn.btn-default(type='submit' value='Oui' role='button')

block footscript